{"version":3,"file":"log.min.js","names":["intervalHandle","timeout","reloadLog","myCallback","b","url","akeeba","System","getOptions","console","log","Ajax","window","ajax","method","data","size","document","getElementById","value","lines","success","text","innerHTML","startAutoRefresh","stopAutoRefresh","classList","remove","setInterval","attributes","ariaNow","style","width","clearInterval","add","onDOMContentLoaded","addEventListener","e","elCheckbox","target","checked","readyState"],"sources":["log.js"],"sourcesContent":["/*\n * @package   panopticon\n * @copyright Copyright (c)2023-2024 Nicholas K. Dionysopoulos / Akeeba Ltd\n * @license   https://www.gnu.org/licenses/agpl-3.0.txt GNU Affero General Public License, version 3 or later\n */\n\n\n(() => {\n    let timeout = 10;\n    let intervalHandle;\n\n    const reloadLog = (myCallback) => {\n        const url = akeeba.System.getOptions('log', {})?.url;\n\n        if (!url)\n        {\n            return;\n        }\n\n        console.log(akeeba.Ajax)\n\n        window.akeeba.Ajax.ajax(url, {\n            method: 'GET',\n            data: {\n                size:  document.getElementById('size').value,\n                lines: document.getElementById('lines').value,\n            },\n            success: (text) => {\n                document.getElementById('logTableContainer').innerHTML = text;\n\n                if (typeof myCallback === 'function')\n                {\n                    myCallback();\n                }\n            }\n        })\n    }\n\n    const startAutoRefresh = () => {\n        stopAutoRefresh();\n\n        document.getElementById('autoRefreshContainer').classList.remove('d-none');\n\n        intervalHandle = window.setInterval(() => {\n            timeout--;\n            document.getElementById('autoRefreshProgress').attributes.ariaNow = timeout;\n            document.getElementById('autoRefreshBar').style.width = (timeout * 10) + '%';\n\n            if (timeout == 0)\n            {\n                stopAutoRefresh();\n                reloadLog(() => {\n                    startAutoRefresh();\n                })\n            }\n        }, 1000);\n    }\n\n    const stopAutoRefresh = () => {\n        if (intervalHandle) {\n            window.clearInterval(intervalHandle);\n        }\n\n        document.getElementById('autoRefreshContainer').classList.add('d-none');\n        document.getElementById('autoRefreshProgress').attributes.ariaNow = 10;\n        document.getElementById('autoRefreshBar').style.width = '100%';\n\n        timeout = 10;\n    }\n\n    const onDOMContentLoaded = () => {\n        document.getElementById('autoRefresh').addEventListener('change', (e) => {\n           const elCheckbox = e.target;\n\n           if (elCheckbox.checked) {\n               startAutoRefresh();\n           } else {\n               stopAutoRefresh();\n           }\n        });\n\n        document.getElementById('size').addEventListener('change', reloadLog)\n        document.getElementById('lines').addEventListener('change', reloadLog)\n        document.getElementById('reloadLog').addEventListener('click', reloadLog)\n    }\n\n    if (document.readyState === \"loading\") {\n        document.addEventListener(\"DOMContentLoaded\", onDOMContentLoaded);\n    } else {\n        onDOMContentLoaded();\n    }\n})();"],"mappings":"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"}