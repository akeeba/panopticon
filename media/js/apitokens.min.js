window.akeeba=window.akeeba||{},window.akeeba.ApiTokens=window.akeeba.ApiTokens||{},function(a,b,c,d){"use strict";var e={},f=function(b,c,d,f){c.token=e.csrfToken,a.ajax(b,{method:"POST",data:c,success:function(a){try{var b=JSON.parse(a);d(b)}catch(a){f&&f(a)}},error:function(a){f&&f(a)}})};c.create=function(){var a=d.getElementById("newTokenDescription"),b=a?a.value.trim():"";f(e.createUrl,{description:b},function(b){if(!b.success)return void alert(b.message||"Failed to create token");var c=d.getElementById("newTokenAlert"),e=d.getElementById("newTokenValue");c&&e&&(e.value=b.token,c.classList.remove("d-none")),a&&(a.value=""),window.location.reload()},function(){alert("Failed to create token")})},c.toggle=function(a){f(e.toggleUrl,{id:a},function(a){return a.success?void window.location.reload():void alert(a.message||"Failed to toggle token")},function(){alert("Failed to toggle token")})},c.remove=function(a){confirm(b.Text._("PANOPTICON_APITOKENS_BTN_CONFIRM_DELETE"))&&f(e.removeUrl,{id:a},function(b){if(!b.success)return void alert(b.message||"Failed to delete token");var c=d.querySelector("tr[data-token-id=\""+a+"\"]");c&&c.remove()},function(){alert("Failed to delete token")})},c.showToken=function(a){var b=d.querySelector(".token-value-group[data-id=\""+a+"\"]");return b?b.classList.contains("d-none")?void f(e.tokenUrl,{id:a},function(a){if(!a.success)return void alert(a.message||"Failed to get token value");var c=b.querySelector(".token-value-input");c&&(c.value=a.token),b.classList.remove("d-none")},function(){alert("Failed to get token value")}):void b.classList.add("d-none"):void 0};var g=function(){if(e=b.getOptions("panopticon.apitokens"),!!e){var a=d.getElementById("btnCreateToken");a&&a.addEventListener("click",c.create);var f=d.getElementById("btnCopyNewToken");f&&f.addEventListener("click",function(){var a=d.getElementById("newTokenValue");a&&navigator.clipboard.writeText(a.value)}),d.querySelectorAll(".btn-toggle-token").forEach(function(a){a.addEventListener("click",function(){c.toggle(parseInt(a.dataset.id,10))})}),d.querySelectorAll(".btn-show-token").forEach(function(a){a.addEventListener("click",function(){c.showToken(parseInt(a.dataset.id,10))})}),d.querySelectorAll(".btn-delete-token").forEach(function(a){a.addEventListener("click",function(){c.remove(parseInt(a.dataset.id,10))})}),d.querySelectorAll(".btn-copy-token").forEach(function(a){a.addEventListener("click",function(){var b=a.closest(".token-value-group").querySelector(".token-value-input");b&&navigator.clipboard.writeText(b.value)})})}};"loading"===d.readyState?d.addEventListener("DOMContentLoaded",g):g()}(akeeba.Ajax,akeeba.System,window.akeeba.ApiTokens,document);

//# sourceMappingURL=apitokens.min.js.map