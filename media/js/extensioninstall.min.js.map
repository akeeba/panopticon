{"version":3,"file":"extensioninstall.min.js","names":["document","akeeba","getStoredSelection","raw","localStorage","getItem","JSON","parse","e","saveSelection","ids","setItem","stringify","toggleSite","siteId","checked","includes","push","filter","id","updateCheckAllState","checkAll","getElementById","checkboxes","querySelectorAll","allChecked","length","Array","from","every","cb","ExtensionInstall","onCheckboxChange","forEach","parseInt","dataset","toggleAll","submitSelection","alert","field","value","removeItem","submit","addEventListener","window"],"sources":["extensioninstall.js"],"sourcesContent":["/*\n * @package   panopticon\n * @copyright Copyright (c)2023-2026 Nicholas K. Dionysopoulos / Akeeba Ltd\n * @license   https://www.gnu.org/licenses/agpl-3.0.txt GNU Affero General Public License, version 3 or later\n */\n\n;// noinspection JSUnusedGlobalSymbols\n((document, akeeba) =>\n{\n    \"use strict\";\n\n    const STORAGE_KEY = \"panopticon.extensioninstall.selectedSites\";\n\n    /**\n     * Get the selected site IDs from localStorage.\n     *\n     * @returns {number[]}\n     */\n    function getStoredSelection()\n    {\n        try\n        {\n            const raw = localStorage.getItem(STORAGE_KEY);\n\n            return raw ? JSON.parse(raw) : [];\n        }\n        catch (e)\n        {\n            return [];\n        }\n    }\n\n    /**\n     * Save the selected site IDs to localStorage.\n     *\n     * @param {number[]} ids\n     */\n    function saveSelection(ids)\n    {\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(ids));\n    }\n\n    /**\n     * Toggle a site ID in the stored selection.\n     *\n     * @param {number} siteId\n     * @param {boolean} checked\n     */\n    function toggleSite(siteId, checked)\n    {\n        let ids = getStoredSelection();\n\n        if (checked)\n        {\n            if (!ids.includes(siteId))\n            {\n                ids.push(siteId);\n            }\n        }\n        else\n        {\n            ids = ids.filter(id => id !== siteId);\n        }\n\n        saveSelection(ids);\n    }\n\n    /**\n     * Restore checkbox states from localStorage on page load.\n     */\n    function restoreCheckboxes()\n    {\n        const ids = getStoredSelection();\n        const checkboxes = document.querySelectorAll(\".extensioninstall-site-cb\");\n\n        checkboxes.forEach(cb =>\n        {\n            const siteId = parseInt(cb.dataset.siteId, 10);\n\n            cb.checked = ids.includes(siteId);\n        });\n\n        updateCheckAllState();\n    }\n\n    /**\n     * Update the \"check all\" checkbox state based on individual checkboxes.\n     */\n    function updateCheckAllState()\n    {\n        const checkAll = document.getElementById(\"checkAll\");\n\n        if (!checkAll)\n        {\n            return;\n        }\n\n        const checkboxes = document.querySelectorAll(\".extensioninstall-site-cb\");\n        const allChecked = checkboxes.length > 0\n            && Array.from(checkboxes).every(cb => cb.checked);\n\n        checkAll.checked = allChecked;\n    }\n\n    /**\n     * Handle a checkbox change event.\n     */\n    akeeba.ExtensionInstall = akeeba.ExtensionInstall || {};\n\n    akeeba.ExtensionInstall.onCheckboxChange = function()\n    {\n        const checkboxes = document.querySelectorAll(\".extensioninstall-site-cb\");\n\n        checkboxes.forEach(cb =>\n        {\n            const siteId = parseInt(cb.dataset.siteId, 10);\n\n            toggleSite(siteId, cb.checked);\n        });\n\n        updateCheckAllState();\n    };\n\n    /**\n     * Toggle all checkboxes on the current page.\n     *\n     * @param {boolean} checked\n     */\n    akeeba.ExtensionInstall.toggleAll = function(checked)\n    {\n        const checkboxes = document.querySelectorAll(\".extensioninstall-site-cb\");\n\n        checkboxes.forEach(cb =>\n        {\n            cb.checked = checked;\n\n            const siteId = parseInt(cb.dataset.siteId, 10);\n\n            toggleSite(siteId, checked);\n        });\n    };\n\n    /**\n     * Collect all selected site IDs and submit the form to the review task.\n     */\n    akeeba.ExtensionInstall.submitSelection = function()\n    {\n        const ids = getStoredSelection();\n\n        if (ids.length === 0)\n        {\n            alert(\"Please select at least one site.\");\n\n            return;\n        }\n\n        const field = document.getElementById(\"site_ids\");\n\n        if (field)\n        {\n            field.value = JSON.stringify(ids);\n        }\n\n        // Clear the stored selection after submitting\n        localStorage.removeItem(STORAGE_KEY);\n\n        document.getElementById(\"adminForm\").submit();\n    };\n\n    // Restore checkboxes on page load\n    document.addEventListener(\"DOMContentLoaded\", restoreCheckboxes);\n\n})(document, window.akeeba = window.akeeba || {});\n"],"mappings":"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","ignoreList":[]}