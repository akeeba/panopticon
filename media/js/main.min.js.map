{"version":3,"file":"main.min.js","names":["heartBeatCheck","options","akeeba","System","getOptions","Ajax","ajax","url","type","cache","success","responseText","response","JSON","parse","e","targetId","warningId","elTarget","document","getElementById","classList","remove","add","usageStats","enabled","onDOMContentLoaded","window","setInterval","setTimeout","tooltipTriggerList","querySelectorAll","tooltipList","_toConsumableArray","map","tooltipTriggerEl","bootstrap","Tooltip","forEach","element","Choices","allowHTML","placeholder","placeholderValue","removeItemButton","readyState","addEventListener"],"sources":["main.js"],"sourcesContent":["/*\n * @package   panopticon\n * @copyright Copyright (c)2023-2024 Nicholas K. Dionysopoulos / Akeeba Ltd\n * @license   https://www.gnu.org/licenses/agpl-3.0.txt GNU Affero General Public License, version 3 or later\n */\n\n(() =>\n{\n    const heartBeatCheck = () =>\n    {\n        const options = akeeba.System.getOptions(\"panopticon.heartbeat\")\n        akeeba.Ajax.ajax(\n            options.url,\n            {\n                type:    \"GET\",\n                cache:   false,\n                success: (responseText, statusText, xhr) =>\n                         {\n                             let response = null;\n\n                             try\n                             {\n                                 response = JSON.parse(responseText);\n                             }\n                             catch (e)\n                             {\n                                 // Maybe the session expired?\n                                 return;\n                             }\n\n                             const targetId = options.warningId;\n\n                             if (!targetId)\n                             {\n                                 return;\n                             }\n\n                             const elTarget = document.getElementById(targetId);\n\n                             if (!elTarget)\n                             {\n                                 return;\n                             }\n\n                             elTarget.classList.remove(\"d-none\", \"d-block\");\n                             elTarget.classList.add(response ? \"d-none\" : \"d-block\");\n                         }\n            }\n        );\n    }\n\n    const usageStats = () =>\n    {\n        const options = akeeba.System.getOptions(\"panopticon.usagestats\", {});\n\n        if (!options?.enabled)\n        {\n            return;\n        }\n\n        akeeba.Ajax.ajax(\n            options.url,\n            {\n                type:  \"GET\",\n                cache: false,\n            }\n        );\n    };\n\n    const onDOMContentLoaded = () =>\n    {\n        // Set up the CRON heartbeat check\n        window.setInterval(heartBeatCheck, 30000);\n\n        heartBeatCheck();\n\n        window.setTimeout(usageStats, 500);\n\n        // Enable BS tooltips\n        const tooltipTriggerList = document.querySelectorAll(\"[data-bs-toggle=\\\"tooltip\\\"]\")\n        const tooltipList        = [...tooltipTriggerList].map(\n            tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))\n\n        // Enable Choices.js\n        document\n            .querySelectorAll(\".js-choice\")\n            .forEach((element) =>\n            {\n                new Choices(\n                    element,\n                    {\n                        allowHTML:        false,\n                        placeholder:      true,\n                        placeholderValue: \"\",\n                        removeItemButton: true\n                    }\n                );\n            });\n    }\n\n    if (document.readyState === \"loading\")\n    {\n        document.addEventListener(\"DOMContentLoaded\", onDOMContentLoaded);\n    }\n    else\n    {\n        onDOMContentLoaded();\n    }\n})()"],"mappings":"+9BAMA,CAAC,UACD,IACU,CAAAA,CAAc,CAAG,QAAAA,CAAA,CACvB,CACI,GAAM,CAAAC,CAAO,CAAGC,MAAM,CAACC,MAAM,CAACC,UAAU,CAAC,sBAAsB,CAAC,CAChEF,MAAM,CAACG,IAAI,CAACC,IAAI,CACZL,CAAO,CAACM,GAAG,CACX,CACIC,IAAI,CAAK,KAAK,CACdC,KAAK,GAAS,CACdC,OAAO,CAAE,SAAAA,QAACC,CAAY,CACb,CACI,GAAI,CAAAC,CAAQ,CAAG,IAAI,CAEnB,GACA,CACIA,CAAQ,CAAGC,IAAI,CAACC,KAAK,CAACH,CAAY,CACtC,CACA,MAAOI,CAAC,CACR,CAEI,MACJ,CAEA,GAAM,CAAAC,CAAQ,CAAGf,CAAO,CAACgB,SAAS,CAElC,GAAKD,CAAQ,EAKb,GAAM,CAAAE,CAAQ,CAAGC,QAAQ,CAACC,cAAc,CAACJ,CAAQ,CAAC,CAE7CE,CAAQ,GAKbA,CAAQ,CAACG,SAAS,CAACC,MAAM,CAAC,QAAQ,CAAE,SAAS,CAAC,CAC9CJ,CAAQ,CAACG,SAAS,CAACE,GAAG,CAACX,CAAQ,CAAG,QAAQ,CAAG,SAAS,CAAC,EAC3D,CACb,CACJ,CACJ,CAAC,CAEKY,CAAU,CAAG,QAAAA,CAAA,CACnB,CACI,GAAM,CAAAvB,CAAO,CAAGC,MAAM,CAACC,MAAM,CAACC,UAAU,CAAC,uBAAuB,CAAE,CAAC,CAAC,CAAC,CAAC,OAEjEH,CAAO,WAAPA,CAAO,EAAPA,CAAO,CAAEwB,OAAO,EAKrBvB,MAAM,CAACG,IAAI,CAACC,IAAI,CACZL,CAAO,CAACM,GAAG,CACX,CACIC,IAAI,CAAG,KAAK,CACZC,KAAK,GACT,CACJ,CACJ,CAAC,CAEKiB,CAAkB,CAAG,QAAAA,CAAA,CAC3B,CAEIC,MAAM,CAACC,WAAW,CAAC5B,CAAc,CAAE,GAAK,CAAC,CAEzCA,CAAc,CAAC,CAAC,CAEhB2B,MAAM,CAACE,UAAU,CAACL,CAAU,CAAE,GAAG,CAAC,IAG5B,CAAAM,CAAkB,CAAGX,QAAQ,CAACY,gBAAgB,CAAC,8BAA8B,CAAC,CAC9EC,CAAW,CAAUC,kBAAA,CAAIH,CAAkB,EAAEI,GAAG,CAClD,SAAAC,CAAgB,QAAI,IAAI,CAAAC,SAAS,CAACC,OAAO,CAACF,CAAgB,CAAC,EAAC,CAGhEhB,QAAQ,CACHY,gBAAgB,CAAC,YAAY,CAAC,CAC9BO,OAAO,CAAC,SAACC,CAAO,CACjB,CACI,GAAI,CAAAC,OAAO,CACPD,CAAO,CACP,CACIE,SAAS,GAAc,CACvBC,WAAW,GAAW,CACtBC,gBAAgB,CAAE,EAAE,CACpBC,gBAAgB,GACpB,CACJ,CACJ,CAAC,CACT,CAAC,CAE2B,SAAS,GAAjCzB,QAAQ,CAAC0B,UAAwB,CAEjC1B,QAAQ,CAAC2B,gBAAgB,CAAC,kBAAkB,CAAEpB,CAAkB,CAAC,CAIjEA,CAAkB,CAAC,CAE3B,CAAC,EAAE,CAAC"}